rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Business logos - Allow authenticated users to upload business logos
    match /business-logos/{allPaths=**} {
      allow read: if true; // Anyone can read business logos (for displaying in app)
      allow write: if request.auth != null; // Only authenticated users can upload/modify
    }
    
    // Allow authenticated users to upload any files to business-logos directory
    // This covers patterns like: businessId_logo.jpg, userId_businessLogo.jpg, etc.
    match /business-logos/{fileName} {
      allow read: if true; // Public read access for displaying logos
      allow write: if request.auth != null; // Authenticated users can upload
    }
      // User profile images - Allow authenticated users to upload their profile images
    match /user-profiles/{fileName} {
      allow read: if true; // Anyone can read profile images (for displaying in app)
      allow write: if request.auth != null && request.auth.uid != null; // Only authenticated users with valid UID can upload/modify
    }
    
    // Default rule - deny all other access
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
